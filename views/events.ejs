<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Events - Match Hub</title>
    <link rel="stylesheet" href="/css/modern-style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" />
    <link rel="icon" href="/images/logo.png" />
</head>
<body>
    <nav class="navbar-modern">
        <div class="nav-container">
            <a href="/" class="nav-logo">
                <img src="/images/logo.png" height="40" width="40" style="vertical-align:middle;margin-right:10px;" onerror="this.style.display='none'">
                <span style="font-family:var(--font-display);font-size:1.5rem;letter-spacing:0.05em;">MATCH HUB</span>
            </a>
            <ul class="nav-menu">
                <li><a href="/" class="nav-link">Home</a></li>
                <li><a href="/checkevents" class="nav-link active">Events</a></li>
                <li><a href="/contactUs" class="nav-link">Contact Us</a></li>
                <% var Currentuser = JSON.parse(localStorage.getItem("users")) %>
                <% if(Currentuser == null) { %>
                    <li><a href="/loginUser" class="nav-link">Login</a></li>
                    <li><a href="/registerUser" class="btn btn-primary" style="padding:0.5rem 1.5rem;">Sign Up</a></li>
                <% } %>
                <% if(Currentuser != null) { %>
                    <li><a href="/" class="nav-link"><i class="fas fa-user"></i> <%= Currentuser.username %></a></li>
                    <li><a href="/logout" class="btn btn-accent" style="padding:0.5rem 1.5rem;">Logout</a></li>
                <% } %>
            </ul>
        </div>
    </nav>

    <div class="mt-80"></div>

    <section class="events-section" style="background:#1E1E1E;min-height:100vh;padding:80px 20px 60px;">
        <div class="section-title">
            <h2 style="color:#00E5FF;font-family:var(--font-display);font-size:3rem;letter-spacing:0.08em;margin-bottom:1rem;">ALL SPORTS EVENTS</h2>
            <p style="color:#FFFFFF;font-size:1.2rem;font-weight:500;">Browse and register for upcoming sports competitions</p>
        </div>
        <div class="events-grid">
            <% if(event && event.length > 0) { %>
                <% event.forEach(function(evt, index) { %>
                    <div class="event-card fade-in" style="animation-delay:<%= index * 0.05 %>s;">
                        <img src="<%= evt.photo || '/images/logo.png' %>" alt="<%= evt.name %>" class="event-card-image" onerror="this.src='/images/logo.png'" loading="lazy" />
                        <div class="event-card-content">
                            <span class="event-card-date"><i class="fas fa-calendar"></i> <%= evt.datestart ? new Date(evt.datestart).toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}) : 'TBA' %></span>
                            <h3 class="event-card-title"><%= evt.name %></h3>
                            <div class="event-card-details">
                                <div class="event-detail-item"><i class="fas fa-map-marker-alt"></i><span><%= evt.venue || 'Location TBA' %></span></div>
                                <div class="event-detail-item"><i class="fas fa-users"></i><span><%= evt.eventcategory || 'Open' %></span></div>
                            </div>
                            <div class="event-card-footer">
                                <div class="event-price"><span class="event-price-label">Entry Fee</span><%= evt.registerationfee || 0 %></div>
                                <a href="/fetchdetails/<%= evt.id %>" class="btn btn-primary">View Details <i class="fas fa-arrow-right"></i></a>
                            </div>
                        </div>
                    </div>
                <% }) %>
            <% } else { %>
                <div class="no-data" style="grid-column:1/-1;">
                    <div class="no-data-icon"><i class="fas fa-calendar-xmark"></i></div>
                    <h3>No Events Available</h3>
                    <p>There are currently no events to display.</p>
                    <a href="/" class="btn btn-primary">Go Home</a>
                </div>
            <% } %>
        </div>
    </section>

    <footer class="footer-modern">
        <div class="footer-content">
            <div class="footer-section">
                <h3 style="font-family:var(--font-display);font-size:1.8rem;letter-spacing:0.05em;">MATCH HUB</h3>
                <p style="color:#e5e7eb;margin-top:1rem;font-size:0.95rem;">Where champions are made. Every match, every moment.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="/checkevents">Events</a></li>
                    <li><a href="/contactUs">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Connect</h3>
                <div style="display:flex;gap:1rem;margin-top:1rem;">
                    <a href="#" style="color:white;font-size:1.5rem;transition:color 0.3s;" onmouseover="this.style.color='#00E5FF'" onmouseout="this.style.color='white'"><i class="fab fa-instagram"></i></a>
                    <a href="#" style="color:white;font-size:1.5rem;transition:color 0.3s;" onmouseover="this.style.color='#00E5FF'" onmouseout="this.style.color='white'"><i class="fab fa-facebook"></i></a>
                    <a href="#" style="color:white;font-size:1.5rem;transition:color 0.3s;" onmouseover="this.style.color='#00E5FF'" onmouseout="this.style.color='white'"><i class="fab fa-twitter"></i></a>
                </div>
            </div>
        </div>
        <div class="footer-bottom"><p>&copy; 2024 Match Hub. All rights reserved. <span style="color:#A6FF00;">Built for Champions.</span></p></div>
    </footer>

    <!-- Success Popup Modal -->
    <div id="successModal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:10000;align-items:center;justify-content:center;">
        <div style="background:linear-gradient(135deg,#1E1E1E 0%,#2a2a2a 100%);padding:3rem;border-radius:1.5rem;max-width:450px;text-align:center;border:2px solid #00E5FF;box-shadow:0 0 50px rgba(0,229,255,0.5);animation:modalSlideIn 0.4s ease-out;">
            <div style="width:80px;height:80px;background:linear-gradient(135deg,#A6FF00 0%,#00E5FF 100%);border-radius:50%;margin:0 auto 1.5rem;display:flex;align-items:center;justify-content:center;box-shadow:0 0 30px rgba(166,255,0,0.6);">
                <i class="fas fa-check" style="font-size:3rem;color:#1E1E1E;"></i>
            </div>
            <h2 style="color:#00E5FF;font-size:2rem;margin-bottom:1rem;font-family:var(--font-display);letter-spacing:0.05em;">SUCCESS!</h2>
            <p style="color:#FFFFFF;font-size:1.2rem;margin-bottom:0.5rem;font-weight:600;">Registration Completed!</p>
            <p style="color:#A6FF00;font-size:1rem;margin-bottom:2rem;">Your event registration has been successfully submitted.</p>
            <button onclick="closeModal()" class="btn btn-accent" style="padding:0.8rem 2.5rem;font-size:1.1rem;">
                <i class="fas fa-times-circle"></i> Close
            </button>
        </div>
    </div>

    <style>
        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>

    <script>
        // Optimized scroll handler with throttling
        let scrollTimeout;
        let ticking = false;
        
        function updateNavbar() {
            const navbar = document.querySelector('.navbar-modern');
            if (window.scrollY > 50) {
                navbar.classList.add('scrolled');
            } else {
                navbar.classList.remove('scrolled');
            }
            ticking = false;
        }
        
        window.addEventListener('scroll', function() {
            if (!ticking) {
                window.requestAnimationFrame(updateNavbar);
                ticking = true;
            }
        }, { passive: true });
        
        // Check if registration was successful
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('success') === 'true') {
            document.getElementById('successModal').style.display = 'flex';
            // Remove success parameter from URL without reloading
            window.history.replaceState({}, document.title, window.location.pathname);
        }
        
        function closeModal() {
            document.getElementById('successModal').style.display = 'none';
        }
        
        // Close modal when clicking outside
        document.getElementById('successModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>
